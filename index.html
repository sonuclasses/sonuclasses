<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sonu Classes</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #f4f4f9; text-align: center; margin: 0; padding: 0; }
        header { background-color: #2E7D32; color: white; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        h1 { margin: 0; font-size: 24px; }
        .profile-menu { position: relative; display: inline-block; }
        .profile-icon { background-color: white; color: #2E7D32; width: 40px; height: 40px; border-radius: 50%; display: flex; justify-content: center; align-items: center; cursor: pointer; font-weight: bold; border: 2px solid #fff; font-size: 18px; text-transform: uppercase; }
        .dropdown-content { display: none; position: absolute; right: 0; background-color: white; min-width: 180px; box-shadow: 0 8px 16px rgba(0,0,0,0.2); border-radius: 8px; z-index: 1; margin-top: 10px; }
        .dropdown-content p { color: #333; padding: 12px; margin: 0; border-bottom: 1px solid #eee; font-size: 14px; font-weight: bold; overflow: hidden; text-overflow: ellipsis; }
        .dropdown-content button { width: 100%; padding: 12px; border: none; background: none; color: red; cursor: pointer; font-weight: bold; border-radius: 0 0 8px 8px; }
        .dropdown-content button:hover { background-color: #f9f9f9; }
        .show { display: block; }
        .container { margin: 40px auto; width: 90%; max-width: 800px; }
        .class-btn { display: inline-block; background-color: #1976D2; color: white; padding: 15px 30px; margin: 10px; text-decoration: none; border-radius: 8px; font-size: 20px; font-weight: bold; width: 200px; }
    </style>
</head>
<body style="display: none;" id="main-body">

<header>
    <h1>Sonu Classes</h1>
    <div class="profile-menu">
        <div class="profile-icon" id="user-initial" onclick="toggleMenu()">?</div>
        
        <div id="myDropdown" class="dropdown-content">
            <p id="user-display-name">नमस्ते!</p>
            <button onclick="confirmLogout()">लॉगआउट करें</button>
        </div>
    </div>
</header>

<div class="container">
    <h2>अपनी क्लास चुनें:</h2>
    <a href="#" class="class-btn">Class 8</a>
    <a href="#" class="class-btn">Class 9</a>
    <a href="#" class="class-btn">Class 10</a>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDCzAhpQonWiNDtWmyox5QdPd4xRbpOy30",
    authDomain: "sonuclasses-b19db.firebaseapp.com",
    projectId: "sonuclasses-b19db",
    storageBucket: "sonuclasses-b19db.firebasestorage.app",
    messagingSenderId: "166740602272",
    appId: "1:166740602272:web:af9131ad8c5e4c8fca08c5"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  const mainBody = document.getElementById('main-body');
  const userInitial = document.getElementById('user-initial');
  const userDisplayName = document.getElementById('user-display-name');

  window.toggleMenu = function() {
    document.getElementById("myDropdown").classList.toggle("show");
  }

  window.confirmLogout = function() {
    let check = confirm("क्या आप सच में लॉगआउट करना चाहते हैं?");
    if (check) {
      signOut(auth).then(() => {
        window.location.replace("login.html");
      });
    }
  }

  onAuthStateChanged(auth, (user) => {
    if (user) {
      mainBody.style.display = "block";
      
      // ईमेल से नाम निकालने का जादू
      let email = user.email;
      let name = email.split('@')[0]; // @ से पहले वाला हिस्सा
      
      userDisplayName.innerText = "नमस्ते, " + name + "!";
      userInitial.innerText = name.charAt(0); // नाम का पहला अक्षर गोल बटन में
    } else {
      window.location.replace("login.html");
    }
  });

  window.onclick = function(event) {
    if (!event.target.matches('.profile-icon')) {
      var dropdowns = document.getElementsByClassName("dropdown-content");
      for (var i = 0; i < dropdowns.length; i++) {
        var openDropdown = dropdowns[i];
        if (openDropdown.classList.contains('show')) {
          openDropdown.classList.remove('show');
        }
      }
    }
  }
</script>
</body>
</html>
